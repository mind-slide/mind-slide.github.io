(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{124:function(e,t){},125:function(e,t){},126:function(e,t){},255:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),c=a(120),s=a(251),r=a(2),o=a(1);let l;t.default=e=>{const[t,a]=Object(n.useState)("#4d4d4d"),[d,m]=Object(n.useState)(!1),[h,f]=Object(n.useState)(!1);return i.a.useEffect(()=>{if(l=new c.fabric.Canvas("canvas"),l.isDrawingMode=!1,l.freeDrawingBrush.width=4,e.img){let t=e.img;e.img.startsWith("data:image/svg+xml,")&&(t=Object(r.a)(e.img)),t.startsWith("<?xml")?c.fabric.loadSVGFromString(t,(function(e,t){e.forEach(e=>{const a=c.fabric.util.groupSVGElements([e],t);l.add(a)})})):c.fabric.Image.fromURL(e.img,(function(e){const t=e.set({left:0,top:0});l.add(t)}))}},[]),i.a.useEffect(()=>{l.isDrawingMode=h},[h]),i.a.createElement("div",Object.assign({className:o.a.canvasEditor},r.r,{tabIndex:0,onKeyDown:e=>{const t={Backspace:()=>{e.preventDefault(),e.stopPropagation(),l.remove(l.getActiveObject())}};t[e.key]&&t[e.key]()}}),i.a.createElement("div",{className:o.a.flex},i.a.createElement("div",{className:o.a.btn,onClick:()=>{f(!h)}},i.a.createElement("span",{style:{border:h?"none":"1px solid white"}},"选择"),"/",i.a.createElement("span",{style:{border:h?"1px solid white":"none"}},"画笔")),i.a.createElement("div",{className:o.a.btn,onClick:()=>{l.add(new c.fabric.Circle({radius:100,stroke:t,strokeWidth:4,fill:"transparent",scaleY:.5,top:100,left:100,originX:"center",originY:"center"})),f(!1)}},"圆形"),i.a.createElement("div",{className:o.a.btn,onClick:()=>{l.add(new c.fabric.Rect({top:100,left:100,width:60,height:70,fill:"transparent",stroke:t,strokeWidth:4})),f(!1)}},"矩形"),i.a.createElement("div",{className:o.a.btn,onClick:()=>{const e=prompt("请输入");e&&(l.add(new c.fabric.Text(e,{fontSize:30,fill:t,top:100,left:100,originX:"center",originY:"center"})),f(!1))}},"文本"),i.a.createElement("div",{className:o.a.btn,onClick:()=>{const e=l.getActiveObject();e?l.remove(e):alert("请先选择要删除的元素")}},"删除"),i.a.createElement("div",{className:o.a.btnColor,onClick:()=>m(!d),style:{background:t}},d?i.a.createElement(s.a,{color:t,onChange:e=>{const t=l.getActiveObject();t&&(t.setOptions(t.stroke?{stroke:e.hex}:{fill:e.hex}),l.renderAll()),l.freeDrawingBrush.color=e.hex,a(e.hex)}}):null),i.a.createElement("div",{className:o.a.flex1}),i.a.createElement("div",{className:o.a.btn,onClick:()=>{if(!l.getObjects().length)return;l.discardActiveObject();const t=new c.fabric.ActiveSelection(l.getObjects(),{canvas:l});l.setActiveObject(t),t.set("left",0),t.set("top",0);const{width:a,height:n}=t.getBoundingRect(),i=l.height,s=l.width;l.setHeight(n),l.setWidth(a),e.onCommit(l.toSVG(),{width:a,height:n}),l.setHeight(i),l.setWidth(s)}},"确定"),i.a.createElement("div",{className:o.a.btn,onClick:()=>{e.onClose()}},"关闭")),i.a.createElement("canvas",{id:"canvas",width:window.innerWidth-40-e.slideWidth,height:window.innerHeight}))}}}]);